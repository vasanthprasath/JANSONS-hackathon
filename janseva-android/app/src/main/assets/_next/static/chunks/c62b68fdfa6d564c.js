(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94179,e=>{"use strict";var t=e.i(43476),s=e.i(47163);function a({className:e,variant:a="default",...r}){return(0,t.jsx)("div",{className:(0,s.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2",{default:"border-transparent bg-blue-600 text-white hover:bg-blue-600/80",secondary:"border-transparent bg-slate-100 text-slate-900 hover:bg-slate-100/80",destructive:"border-transparent bg-red-500 text-white hover:bg-red-500/80",outline:"text-slate-950",success:"border-transparent bg-green-500 text-white",warning:"border-transparent bg-amber-500 text-white"}[a],e),...r})}e.s(["Badge",()=>a])},63209,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},87413,78894,e=>{"use strict";var t=e.i(43476),s=e.i(94179),a=e.i(75254);let r=(0,a.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>r],78894);var l=e.i(63209);let i=(0,a.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function o({priority:e,size:a="default"}){if(!e)return null;let o="bg-slate-100 text-slate-700",c=(0,t.jsx)(i,{className:"h-3 w-3 mr-1"});switch(e){case"Emergency":o="bg-red-100 text-red-700 border-red-200 animate-pulse-slow",c=(0,t.jsx)(r,{className:"h-3 w-3 mr-1"});break;case"Moderate":o="bg-yellow-100 text-yellow-800 border-yellow-200",c=(0,t.jsx)(l.AlertCircle,{className:"h-3 w-3 mr-1"});break;case"Casual":o="bg-green-100 text-green-700 border-green-200",c=(0,t.jsx)(i,{className:"h-3 w-3 mr-1"})}return(0,t.jsxs)(s.Badge,{variant:"outline",className:`${o} ${"sm"===a?"px-1.5 py-0.5 text-[10px]":"px-2.5 py-0.5 text-xs"} font-medium border`,children:[c,e]})}e.s(["default",()=>o],87413)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},69259,e=>{"use strict";let t="janseva_complaints",s=(e,t,s)=>{let a=`${e} ${t} ${s}`.toLowerCase();return["accident","fire","gas leak","flood","fallen tree","electric shock","sewage overflow","road collapse","water pipeline burst","burst","collapse","danger","hazard","chemical spill","factory fire","industrial gas leak","explosion","safety risk","unsafe","gas leak"].some(e=>a.includes(e))?"Emergency":["street light","garbage","drainage","water leakage","pothole","traffic signal","leak","blocked","pollution","waste","fumes","banking","ticket","staff"].some(e=>a.includes(e))?"Moderate":"Casual"},a=e=>{let t=10;return e.image&&(t+=5),"Emergency"===e.priorityType&&(t+=10),"Moderate"===e.priorityType&&(t+=5),t},r=()=>{let e=localStorage.getItem(t);if(!e)return[];try{return JSON.parse(e)}catch(e){return console.error("Failed to parse complaints",e),[]}},l=async(s,a,l)=>{let{sendNotification:o}=await e.A(4021),c=r(),d=c.findIndex(e=>e.id===s);if(-1!==d){var n,m,h,x;let e,r,u,p=c[d];"Work Completed"===a&&l?.workerProofLocation&&(n=p.lat,m=p.lng,h=l.workerProofLocation.lat,x=l.workerProofLocation.lng,e=i(h-n),r=i(x-m),6371*(2*Math.atan2(Math.sqrt(u=Math.sin(e/2)*Math.sin(e/2)+Math.cos(i(n))*Math.cos(i(h))*Math.sin(r/2)*Math.sin(r/2)),Math.sqrt(1-u)))>.5)&&(l.workerRemarks=(l.workerRemarks||"")+" [FLAG: Location mismatch detected]");let g={...p,status:a,...l};c[d]=g;let f={status:a,date:new Date().toISOString(),completed:!0};c[d].timeline.push(f),localStorage.setItem(t,JSON.stringify(c)),"Resolved"===a?o("user",`Good news! Your complaint #${s} has been marked as RESOLVED.`,"success",s):"In Progress"===a?(o("user",`Work has started on your complaint #${s}.`,"info",s),g.workerId&&o("worker",`New task assigned: Complaint #${s}. Please check details.`,"info",s)):"Work Completed"===a?o("authority",`Work completed for #${s}. Waiting for verification.`,"success",s):"Delayed"===a&&o("admin",`SLA Breach: Complaint #${s} is currently DELAYED.`,"error",s)}};function i(e){return Math.PI/180*e}let o=async()=>{let s=r(),a=!1,l=new Date,{sendNotification:i}=await e.A(4021);s.forEach(e=>{e.workDeadline&&!["Work Completed","Resolved","Rejected"].includes(e.status)&&!e.isOverdue&&l>new Date(e.workDeadline)&&(e.isOverdue=!0,e.alertSentAt=l.toISOString(),("In Progress"===e.status||"Submitted"===e.status)&&(e.status="Delayed",e.timeline.push({status:"Delayed",date:l.toISOString(),completed:!0})),a=!0,e.workerId&&i("worker",`URGENT: Task #${e.id} is Overdue! Please complete immediately.`,"error",e.id),i("authority",`Alert: Task #${e.id} has breached deadline. Worker: ${e.workerId||"Unassigned"}`,"warning",e.id))}),a&&localStorage.setItem(t,JSON.stringify(s))};e.s(["calculateCreditPoints",0,a,"checkOverdueComplaints",0,o,"determinePriority",0,s,"getComplaintById",0,e=>r().find(t=>t.id===e),"getComplaints",0,r,"saveComplaint",0,e=>{e.priorityType||(e.priorityType=s(e.title,e.description,e.category)),e.creditPoints=a(e);let l=r();l.unshift(e),localStorage.setItem(t,JSON.stringify(l))},"updateComplaintStatus",0,l])},80604,e=>{"use strict";var t=e.i(43476),s=e.i(18566),a=e.i(71645),r=e.i(69259),l=e.i(70065),i=e.i(94179),o=e.i(67881),c=e.i(71689),d=e.i(3116),n=e.i(46897),m=e.i(95468),h=e.i(63209);let x=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var u=e.i(84614),p=e.i(87413),g=e.i(22016);function f(){let{id:e}=(0,s.useParams)(),[f,y]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let t=(0,r.getComplaintById)(e);t&&y(t)},[e]),f)?(0,t.jsxs)("div",{className:"min-h-screen bg-slate-50 pb-20 p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(g.default,{href:"/dashboard/track",children:(0,t.jsx)(o.Button,{variant:"ghost",size:"icon",className:"-ml-2",children:(0,t.jsx)(c.ArrowLeft,{className:"h-5 w-5"})})}),(0,t.jsx)("h1",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Grievance Detail"})]}),(0,t.jsxs)(l.Card,{className:"border-slate-200 shadow-sm",children:[(0,t.jsxs)(l.CardHeader,{className:"pb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)(i.Badge,{variant:"outline",className:"text-blue-600 bg-blue-50 border-blue-100",children:f.category}),(0,t.jsx)(p.default,{priority:f.priorityType})]}),(0,t.jsx)(l.CardTitle,{className:"text-lg",children:f.title}),(0,t.jsx)(l.CardDescription,{className:"text-slate-600 mt-2",children:f.description})]}),(0,t.jsxs)(l.CardContent,{className:"space-y-4 pt-0 border-t border-slate-50 mt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(x,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:new Date(f.date).toLocaleDateString()})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(n.MapPin,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:f.location||"Location Captured"})]})]}),f.image&&(0,t.jsx)("div",{className:"rounded-lg overflow-hidden border border-slate-200 mt-2",children:(0,t.jsx)("img",{src:f.image,alt:"Reported Evidence",className:"w-full h-40 object-cover"})})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-wider flex items-center gap-2",children:[(0,t.jsx)(d.Clock,{className:"h-4 w-4"}),"Resolution Timeline"]}),(0,t.jsxs)("div",{className:"relative space-y-8 pl-4 border-l-2 border-slate-200 ml-2 py-4",children:[f.timeline&&f.timeline.map((e,s)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:`absolute -left-[22px] top-1 h-3 w-3 rounded-full border-2 border-white ${e.completed?"bg-blue-600 shadow-[0_0_0_2px_#3b82f644]":"bg-slate-300"}`}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:`text-sm font-semibold ${e.completed?"text-slate-900":"text-slate-500"}`,children:"Work Completed"===e.status?"Under Verification":e.status}),(0,t.jsx)("span",{className:"text-[10px] text-slate-400",children:new Date(e.date).toLocaleString()})]}),(0,t.jsx)("p",{className:"text-xs text-slate-500 leading-relaxed",children:"Submitted"===e.status?"Grievance successfully recorded in JanSeva portal.":"In Progress"===e.status?"Assigned to field worker for resolution.":"Work Completed"===e.status?"Worker has finished the task. Authority verification pending.":"Resolved"===e.status?"Work verified and grievance resolved successfully.":"Action recorded in the system."})]})]},s)),"Resolved"!==f.status&&(0,t.jsxs)("div",{className:"relative opacity-50",children:[(0,t.jsx)("div",{className:"absolute -left-[22px] top-1 h-3 w-3 rounded-full border-2 border-white bg-slate-200"}),(0,t.jsx)("div",{className:"space-y-1",children:(0,t.jsx)("h4",{className:"text-sm font-medium text-slate-400",children:"Next Action Pending"})})]})]})]}),("Work Completed"===f.status||"Resolved"===f.status)&&f.workerProofImage&&(0,t.jsxs)(l.Card,{className:"bg-slate-900 text-white border-0 shadow-lg mt-6",children:[(0,t.jsx)(l.CardHeader,{className:"pb-2",children:(0,t.jsxs)(l.CardTitle,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(m.CheckCircle2,{className:"h-4 w-4 text-green-400"})," Resolution Proof"]})}),(0,t.jsxs)(l.CardContent,{className:"space-y-3",children:[(0,t.jsx)("img",{src:f.workerProofImage,alt:"Completion Proof",className:"w-full h-40 object-cover rounded-md border border-slate-700"}),f.workerRemarks&&(0,t.jsxs)("p",{className:"text-xs text-slate-300 italic p-2 bg-slate-800 rounded",children:['" ',f.workerRemarks,' "']}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-slate-400",children:[(0,t.jsx)(u.User,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Verified by Internal Team via Geo-Tagging"})]})]})]}),f.isOverdue&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-100 p-4 rounded-lg flex items-start gap-3",children:[(0,t.jsx)(h.AlertCircle,{className:"h-5 w-5 text-red-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-bold text-red-800",children:"Delayed Resolution"}),(0,t.jsx)("p",{className:"text-xs text-red-700 mt-1",children:"This grievance has exceeded the expected resolution time. Higher authorities have been alerted."})]})]})]}):(0,t.jsx)("div",{className:"p-10 text-center text-slate-500",children:"Finding grievance records..."})}e.s(["default",()=>f],80604)},4021,e=>{e.v(t=>Promise.all(["static/chunks/9f60f9bd9e2ddc15.js"].map(t=>e.l(t))).then(()=>t(9572)))}]);